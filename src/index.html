<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<body>
</body>
<script type="text/javascript">

class Player {
  constructor(name, cards) {
    this.name = name;
    this.cards = [];
  }
}

class Game {
  constructor(...args) {
    if (args.length <= 4) {
      this.players = [];
      this.setupPlayers(args)
      this.newDeck()
    } else {
      console.log('the game may only have up to 4 players');
    }
  }

  setupPlayers(args) {
    args.forEach(i => {
      const p = new Player(i)
      this.players.push(p)
    })
  }

  getPlayerIndex(name) {
    let index = null;
    this.players.forEach((p, i) => {
      if (p.name === name) {
        index = i;
      }
    })
    return index;
  }

  showPlayers() {
    this.players.forEach(i => {
      console.log(i);
    })
  }

  showCards(name) {
    const index = this.getPlayerIndex(name)
    this.players[index].cards.forEach(i => {
      console.log(i);
    })
  }

  newDeck() {
    const deck = fetch('https://deckofcardsapi.com/api/deck/new/shuffle/?deck_count=1')
    deck
      .then(data => data.json())
      .then(data => {
        this.id = data.deck_id;
        console.log('got deck');
        this.dealCards()
      })
  }

  removePlayer(name) {
    const index = this.getPlayerIndex(name)
    this.players.splice(index, 1)
    console.log(this.players);
    console.log(`removed ${name} from players, ${this.players.length} players left`);
  }

  newPlayer(name) {
    const players = this.players;
    if (players.length < 4) {
      players.push(new Player(name));
      console.log(`the game now has ${players.length} players, welcome ${name}!`);
    } else {
      console.log('you already have 4 players');
    }
  }

  dealCards() {
    const names = []
    this.players.forEach(i => names.push(i.name))
    console.log(names);
    names.forEach(i => this.getCard(i));
  }

  getCard(name) {
    const deal = fetch(`https://deckofcardsapi.com/api/deck/${this.id}/draw/?count=1`)
    deal
      .then(data => data.json())
      .then(data => {
        const index = this.getPlayerIndex(name);
        const card = data.cards[0].code;
        this.players[index].cards.push(card);
        console.log(`dealt ${card} to ${this.players[index].name}`);
      })
  }
}

const game = new Game('ryan', 'caleb', 'akiva')
console.log(game);

</script>
</html>
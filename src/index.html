<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<body>
<canvas></canvas>
</body>
<script>

const tiles = [
  [1, 5],
  [1, 6],
  [2, 5],
  [2, 6],
  [11, 5],
  [11, 6],
  [11, 7],
  [12, 4],
  [12, 8],
  [13, 3],
  [13, 9],
  [14, 3],
  [14, 9],
  [15, 6],
  [16, 4],
  [16, 8],
  [17, 5],
  [17, 6],
  [17, 7],
  [18, 6],
  [21, 3],
  [21, 4],
  [21, 5],
  [22, 3],
  [22, 4],
  [22, 5],
  [23, 2],
  [23, 6],
  [25, 1],
  [25, 2],
  [25, 6],
  [25, 7],
  [35, 3],
  [35, 4],
  [36, 3],
  [36, 4],

  [60, 47],
  [61, 47],
  [62, 47],
  [60, 48],
  [61, 48],
  [62, 48],
  [60, 49],
  [61, 49],
  [62, 49],
  [60, 51],
  [61, 51],
  [62, 51],

  [60, 67],
  [61, 67],
  [62, 67],
  [60, 68],
  [61, 68],
  [62, 68],
  [60, 69],
  [61, 69],
  [62, 69],
  [60, 71],
  [61, 71],
  [62, 71],

  [80, 67],
  [81, 67],
  [82, 67],
  [80, 68],
  [81, 68],
  [82, 68],
  [80, 69],
  [81, 69],
  [82, 69],
  [80, 71],
  [81, 71],
  [82, 71],
]

class Life {
  constructor(size=100) {
    this.canvas = document.querySelector('canvas')
    this.ctx = this.canvas.getContext('2d')
    this.grid = []
    this.size = size
    window.addEventListener('resize', () => this.sizeCanvas())
    this.sizeCanvas()
    this.buildGrid(this.size)
  }

  sizeCanvas() {
    this.canvas.width = window.innerWidth
    this.canvas.height = this.canvas.width
    this.draw()
  }

  buildGrid(len) {
    for (let x = 0; x < len; x++) {
      this.grid[x] = []
      for (let y = 0; y < len; y++) {
        this.grid[x][y] = 0
      }
    }

    tiles.forEach(i => {
      const x = i[0]
      const y = i[1]
      this.grid[x][y] = 1
    })

    this.draw()
  }

  draw() {
    const ctx = this.ctx
    ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)
    ctx.fillStyle = '#75B5D3'
    ctx.strokeStyle = '#ddd'
    ctx.lineWidth = 0.5

    const size = this.canvas.width / this.size

    this.grid.forEach((row, x) => {
      row.forEach((cell, y) => {
        ctx.beginPath()
        ctx.rect(x * size, y * size, size, size)
        if (cell === 1) {
          ctx.fill()
        } else {
          ctx.stroke()
        }
      })
    })

    this.updateCells()
  }

  getNeighbors(arr, x, y) {
    let count = 0
    const len = this.size - 2

    // top left
    if (x > 0 && y > 0) count += arr[x - 1][y - 1]

    // top mid
    if (x > 0) count += arr[x - 1][y]

    // top right
    if (x > 0 && y < len) count += arr[x - 1][y + 1]

    // middle left
    if (y > 0) count += arr[x][y - 1]

    // middle right
    if (y < len) count += arr[x][y + 1]

    // bottom left
    if (x < len && y > 0) count += arr[x + 1][y - 1]

    // bottom mid
    if (x < len) count += arr[x + 1][y]

    // bottom right
    if (x < len && y < len) count += arr[x + 1][y + 1]

    return count
  }

  updateCells() {
    const result = []

    this.grid.forEach((row, x) => {
      result[x] = []
      row.forEach((cell, y) => {
        const count = this.getNeighbors(this.grid, x, y)
        let val = 0

        if (cell === 1) {
          val = (count < 2 || count > 3) ? 0 : 1
        } else {
          val = (count === 3) ? 1 : 0
        }

        result[x][y] = val
      })
    })

    this.grid = result
    requestAnimationFrame(() => this.draw())
  }
}

new Life()

</script>
</html>